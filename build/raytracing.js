!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Raytracing=e():t.Raytracing=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vec3=void 0;var r=n(9),o=n(2),i=function(){function t(t,e,n){this._x=0,this._y=0,this._z=0,this._x=t,this._y=e,this._z=n}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},enumerable:!1,configurable:!0}),t.prototype.minus=function(t){return t?(this._x-=t._x,this._y-=t._y,this._z-=t._z,this):this},t.prototype.add=function(t){return t?(this._x+=t._x,this._y+=t._y,this._z+=t._z,this):this},t.prototype.multiply=function(t){return r.isNumber(t)?(this._x*=t,this._y*=t,this._z*=t):(this._x*=t.x,this._y*=t.y,this._z*=t.z),this},t.prototype.length=function(){return Math.sqrt(this.lengthSquared())},t.prototype.lengthSquared=function(){return this._x*this._x+this._y*this._y+this._z*this._z},t.prototype.log=function(){console.log([this._x,this._y,this._z])},t.add=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e&&e.length?e.reduce((function(e,n){return new t(e.x+n.x,e.y+n.y,e.z+n.z)})):new t},t.minus=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e&&e.length?e.reduce((function(e,n){return new t(e.x-n.x,e.y-n.y,e.z-n.z)})):new t},t.multiply=function(e,n){return r.isNumber(n)?new t(e.x*n,e.y*n,e.z*n):new t(e.x*n.x,e.y*n.y,e.z*n.z)},t.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},t.cross=function(e,n){return new t(e.y*n.z-e.z*n.y,e.z*n.x-e.x*n.z,e.x*n.y-e.y*n.x)},t.unit=function(e){return t.multiply(e,1/e.length())},t.random=function(e,n){return new t(o.randomInRange(e,n),o.randomInRange(e,n),o.randomInRange(e,n))},t.randomInUnitSphere=function(){var e=o.randomInRange(0,2*Math.PI),n=o.randomInRange(-1,1),r=Math.sqrt(1-n*n);return new t(r*Math.cos(e),r*Math.sin(e),n)},t.randomInHemiSphere=function(e){var n=t.randomInUnitSphere();return t.dot(e,n)>0?n:n.multiply(-1)},t.randomInUnitDisk=function(){for(;;){var e=new t(o.randomInRange(-1,1),o.randomInRange(-1,1),0);if(!(e.lengthSquared()>=1))return e}},t}();e.Vec3=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ray=void 0;var r=n(0),o=function(){function t(t,e){this._orig=t,this._dir=e}return Object.defineProperty(t.prototype,"origin",{get:function(){return this._orig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._dir},enumerable:!1,configurable:!0}),t.prototype.at=function(t){return r.Vec3.add(this._orig,this._dir.multiply(t))},t}();e.Ray=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.clamp=e.random=e.randomInRange=e.DegreeToRadians=e.PI=void 0,e.PI=3.141592653589793,e.DegreeToRadians=function(t){return t*e.PI/180},e.randomInRange=function(t,e){return t+Math.random()*e},e.random=function(){return Math.random()},e.clamp=function(t,e,n){return t<e?e:t>n?n:t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.refract=e.reflect=e.Material=void 0;var r=n(0),o=function(){function t(){}return t.prototype.scatter=function(t,e){return{reflected:!1}},t}();e.Material=o,e.reflect=function(t,e){var n=r.Vec3.dot(t,e);return r.Vec3.minus(t,r.Vec3.multiply(e,2*n))},e.refract=function(t,e,n){var o=Math.min(r.Vec3.dot(r.Vec3.multiply(t,-1),e),1),i=r.Vec3.multiply(r.Vec3.add(t,r.Vec3.multiply(e,o)),n),c=r.Vec3.multiply(e,-Math.sqrt(Math.abs(1-i.lengthSquared())));return r.Vec3.add(i,c)}},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Point3=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(n(0).Vec3);e.Point3=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Hittable=e.HitRecord=void 0;var r=n(4),o=n(0),i=function(){function t(){this.t=0,this.fontFace=!1,this.p=new r.Point3,this.normal=new o.Vec3}return t.prototype.setFaceNormal=function(t,e){this.fontFace=o.Vec3.dot(t.direction,e)<0,this.normal=this.fontFace?e:o.Vec3.multiply(e,-1)},t}();e.HitRecord=i;var c=function(){};e.Hittable=c},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.genColor=e.Color=void 0;var i=n(0),c=n(2),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.Vec3);e.Color=u,e.genColor=function(t,e){var n=t.x,r=t.y,o=t.z,i=1/e;return n=Math.sqrt(i*n),r=Math.sqrt(i*r),o=Math.sqrt(i*o),Math.floor(256*c.clamp(n,0,.999))+" "+Math.floor(256*c.clamp(r,0,.999))+" "+Math.floor(256*c.clamp(o,0,.999))+"\n"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ASPECT_RATIO=void 0;var r=n(11),o=n(4),i=n(0),c=n(6),u=n(1),a=n(5),s=n(2),l=n(17),f=n(16);e.ASPECT_RATIO=1.5;for(var p=120/e.ASPECT_RATIO,d=l.randomScene(),h=new o.Point3(13,2,3),y=new o.Point3(0,0,0),_=new i.Vec3(0,1,0),m=new r.Camera(h,y,_,20,e.ASPECT_RATIO,.1,13.5),v="P3\n120 "+p+"\n255\n",b=p-1;b>=0;b--){console.log("\rScanlines remaining: "+b+" ");for(var w=0;w<120;w++){for(var O=new c.Color(0,0,0),g=0;g<50;g++){var V=(w+s.random())/119,P=(b+s.random())/(p-1),j=m.getRay(V,P);O.add(M(j,d,50))}v+=c.genColor(O,50)}}function M(t,e,n){var r=new a.HitRecord;if(n<=0)return new c.Color(0,0,0);if(e.hit(t,.001,1/0,r)){var o=r.material.scatter(t,r),s=o.scattered,l=o.attenuation;if(o.reflected&&s&&l)return i.Vec3.multiply(l,M(s,e,n-1));var f=i.Vec3.add(r.p,r.normal,i.Vec3.randomInHemiSphere(r.normal));return i.Vec3.multiply(M(new u.Ray(r.p,i.Vec3.minus(f,r.p)),e,n-1),.5)}var p=.5*(i.Vec3.unit(t.direction).y+1),d=new c.Color(1,1,1),h=new c.Color(.5,.7,1);return d.multiply(1-p).add(h.multiply(p))}console.log("\nDone\n"),v&&f.writeFile("test.ppm",v,(function(t){console.log(t)}))},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Lambertian=void 0;var i=n(0),c=n(1),u=function(t){function e(e){var n=t.call(this)||this;return n.albedo=e,n}return o(e,t),e.prototype.scatter=function(t,e){var n=i.Vec3.add(e.normal,i.Vec3.randomInUnitSphere());return{scattered:new c.Ray(e.p,n),attenuation:this.albedo,reflected:!0}},e}(n(3).Material);e.Lambertian=u},function(t,e){t.exports=require("util")},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Metal=void 0;var i=n(0),c=n(1),u=n(3),a=function(t){function e(e,n){void 0===n&&(n=1);var r=t.call(this)||this;return r.albedo=e,r.fuzzy=n<1?n:1,r}return o(e,t),e.prototype.scatter=function(t,e){var n=u.reflect(i.Vec3.unit(t.direction),e.normal),r=new c.Ray(e.p,i.Vec3.add(n,i.Vec3.multiply(i.Vec3.randomInUnitSphere(),this.fuzzy)));return{scattered:r,attenuation:this.albedo,reflected:i.Vec3.dot(r.direction,e.normal)>0}},e}(u.Material);e.Metal=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var r=n(0),o=n(1),i=n(2),c=function(){function t(t,e,n,o,c,u,a){var s=i.DegreeToRadians(o),l=2*Math.tan(s/2),f=l*c;this.w=r.Vec3.unit(r.Vec3.minus(t,e)),this.u=r.Vec3.unit(r.Vec3.cross(n,this.w)),this.v=r.Vec3.cross(this.w,this.u),this.origin=t,this.horizontal=r.Vec3.multiply(this.u,f).multiply(a),this.vertical=r.Vec3.multiply(this.v,l).multiply(a),this.lowerLeftCorner=r.Vec3.minus(this.origin,r.Vec3.multiply(this.horizontal,.5),r.Vec3.multiply(this.vertical,.5),r.Vec3.multiply(this.w,a)),this.lensRadius=u/2}return t.prototype.getRay=function(t,e){var n=r.Vec3.randomInUnitDisk().multiply(this.lensRadius),i=r.Vec3.multiply(this.u,n.x).add(r.Vec3.multiply(this.v,n.y)),c=r.Vec3.add(this.lowerLeftCorner,r.Vec3.multiply(this.horizontal,t),r.Vec3.multiply(this.vertical,e)).minus(this.origin).minus(i),u=r.Vec3.add(this.origin,i);return new o.Ray(u,c)},t}();e.Camera=c},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.HittableList=void 0;var i=function(t){function e(e){var n=t.call(this)||this;return n.objects=[],e&&n.add(e),n}return o(e,t),e.prototype.clear=function(){this.objects=[]},e.prototype.add=function(t){this.objects.push(t)},e.prototype.hit=function(t,e,n,r){for(var o=!1,i=n,c=0,u=this.objects;c<u.length;c++){u[c].hit(t,e,i,r)&&(o=!0,i=r.t)}return o},e}(n(5).Hittable);e.HittableList=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sphere=void 0;var r=n(14);Object.defineProperty(e,"Sphere",{enumerable:!0,get:function(){return r.default}})},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),c=n(0),u=function(t){function e(e,n,r){var o=t.call(this)||this;return o.center=e,o.radius=n,o.material=r,o}return o(e,t),e.prototype.hit=function(t,e,n,r){var o=c.Vec3.minus(t.origin,this.center),i=t.direction.lengthSquared(),u=c.Vec3.dot(o,t.direction),a=u*u-i*(o.lengthSquared()-this.radius*this.radius);if(a>0){var s=Math.sqrt(a),l=(-u-s)/i;if(l<n&&l>e){r.t=l,r.p=t.at(r.t);var f=c.Vec3.multiply(c.Vec3.minus(r.p,this.center),1/this.radius);return r.setFaceNormal(t,f),r.material=this.material,!0}if((l=(-u+s)/i)<n&&l>e){r.t=l,r.p=t.at(r.t);f=c.Vec3.multiply(c.Vec3.minus(r.p,this.center),1/this.radius);return r.setFaceNormal(t,f),r.material=this.material,!0}}return!1},e}(i.Hittable);e.default=u},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Dielectric=void 0;var i=n(3),c=n(0),u=n(1),a=n(3),s=n(6),l=function(t){function e(e){var n=t.call(this)||this;return n.ir=e,n}return o(e,t),e.prototype.scatter=function(t,e){var n,r=new s.Color(1,1,1),o=e.fontFace?1/this.ir:this.ir,a=c.Vec3.unit(t.direction),l=Math.min(c.Vec3.dot(c.Vec3.multiply(a,-1),e.normal),1);n=o*Math.sqrt(1-l*l)>1||this.reflectance(l,o)>Math.random()?i.reflect(a,e.normal):i.refract(a,e.normal,o);return{scattered:new u.Ray(e.p,n),attenuation:r,reflected:!0}},e.prototype.reflectance=function(t,e){var n=(1-e)/(1+e);return(n*=n)+(1-n)*Math.pow(1-t,5)},e}(a.Material);e.Dielectric=l},function(t,e){t.exports=require("fs")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomScene=void 0;var r=n(10),o=n(0),i=n(8),c=n(12),u=n(6),a=n(13),s=n(4),l=n(2),f=n(15);e.randomScene=function(){var t=new c.HittableList,e=new i.Lambertian(new u.Color(.5,.5,.5));t.add(new a.Sphere(new s.Point3(0,-2e3,0),2e3,e));for(var n=3;n<5;n++)for(var p=3;p<5;p++){var d=l.random(),h=new s.Point3(n+.9*l.random(),.2,p+.9*l.random());if(o.Vec3.minus(h,new s.Point3(4,.2,0)).length()>.9){console.log(h);var y=void 0;if(d<.8){var _=o.Vec3.random(0,1).multiply(o.Vec3.random(0,1));y=new i.Lambertian(_),t.add(new a.Sphere(h,.2,y))}else if(d<.95){_=o.Vec3.random(.5,1);var m=l.randomInRange(0,.5);y=new r.Metal(_,m),t.add(new a.Sphere(h,.2,y))}else y=new f.Dielectric(1.5),t.add(new a.Sphere(h,.2,y))}}return new f.Dielectric(1.5),new i.Lambertian(new u.Color(.4,.2,.1)),new r.Metal(new u.Color(.7,.6,.5),0),t}}]).default}));
//# sourceMappingURL=raytracing.js.map